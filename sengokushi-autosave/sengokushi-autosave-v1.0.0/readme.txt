戦国史でオートセーブ等を行うために作ったAutoHotkey用ユーザー操作補助スクリプトです。
AutoHotkey導入後に「sengokushi-autosave-v1.0.0.ahk」をメモ帳で開くなどして、設定を編集後にスクリプトをクリックして使用します。
終了や一時停止などはタスクトレイのアイコンを右クリックして行えます。



以下の文はahkファイル内の記述を抜き出したものです。
詳細はスクリプト内を参照してください。


概要: 戦国史SE, 戦国史FEでオートセーブ、クイックセーブ、ワンクリック内政（実験的機能）を行うユーザー操作補助スクリプトです。
使用にはAutoHotkey（以下AHK） v1.1.31以上の導入が必要です（セーブファイル名に日本語を使う場合はユニコード版推奨）。
スクリプト実行中は、マウスのセンターボタン・サイドボタン2、キーボードのF2～F3およびF7～F12がゲーム用のキー割り当てに変更されます。
必要に応じてAHKをサスペンド（戦国史が非アクティブ中にセンタークリック、もしくはタスクトレイのアイコンから可）してホットキーを無効化してください。
各種設定は48行目から記述されています。

・オートセーブは戦国史がアクティブかつ、ユーザーが一定時間操作をしない場合に行われます。

・オートセーブ、クイックセーブは共通してセーブファイル名は「プレフィクス+スプリッタ文字+YYYYMMDD-HH24MISS」になります。
例えばデフォルトでは、「sengokushi 20210613-201706」のようになります。プレフィクス・スプリッタは変更可能ですが、
上書き保存時以外は日付時刻は強制付与されます。

・ワンクリック内政は、商業開発・新田開発・産業開発・鉄砲生産の4つを実装しています。不要なものはホットキーでoffにできます。
これは実験的な要素であり、実行環境によっては動かない可能性があります。
動作が不正確な場合、129行目の`sleepDuration1`の値を増やすことで改善されるかもしれません。

・ホットキーの変更は416行目以降を書き換えてください。
http://ahkwiki.net/KeyList
http://ahkwiki.net/Hotkeys

---------------------------------------------------------------------------------------------------------------------
クイック・リファレンス

マウス
センターボタン: クイックセーブ。また戦国史がアクティブ中はサスペンドの中止、非アクティブ時はサスペンドが有効化されます。
サイドボタン2: ワンクリック内政。

キーボード
F2: オートセーブの有効/無効切り替え。
F3: 上書きセーブの有効/無効切り替え。
F7: ワンクリック内政の一括有効/無効切り替え。
F8: 商業開発の有効/無効切り替え。
F9: 新田開発の有効/無効切り替え。
F10: 産業開発の有効/無効切り替え。
F11: 鉄砲生産の有効/無効切り替え。
F12: セーブファイルフォルダを開く。

※キーボードのホットキーはF12以外はすべてブール値の切り替えを行うためのみに用意されています。これらの切り替えが不要な場合はすべて削除しても動作します。
